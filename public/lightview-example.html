<head>
    <script src="./assets/js/lightview.js"></script>
    <script type="application/json" id="json-example">
        {
            "tagName":"div",
            "attributes": {
                "style": "font-size:${fontSize}px; color:blue;",
                "href": "./lv-test.html",
                "target": "_self"
            },
            "children": [
                "hello ${name}",
                {
                    "tagName":"div",
                    "attributes": {"src":"./lv-test.html"}
                },
                {
                    "tagName":"div",
                    "attributes":{"src":"./lv-test.json"}
                }
            ]
        }
    </script>
</head>
<body>
    <div id="app"></div>
    <script>
        lvDOM.render({
            tagName:"div",
            shadowRoot:[
                "hello world!",
                {
                    tagName:"div",
                    attributes:{src:'./lv-test.html'}
                }
            ]},{replaceEl:document.currentScript});
    </script>
    <script>
        const userState = lvDOM.state({name:"Bob",fontSize:20});
        lvDOM.render(document.getElementById("json-example"),{replaceEl:document.currentScript,state:userState});
        setTimeout(() => {
            userState.name = "Alice";
            userState.fontSize = 10;
        }, 2000);
    </script>
    <script>
        lvHTML.render(document.getElementById("json-example"),{state:{name:"Joe",fontSize:30},nonce:"abc123"}).then(html => {
            const fragment = new DOMParser().parseFromString(html, "text/html");
            const scripts = fragment.body.querySelectorAll("script");
            document.body.append(...fragment.body.childNodes);
            scripts.forEach(script => {
                const newScript = document.createElement("script");
                newScript.innerText = script.innerText;
                for (const attr of script.attributes) {
                    newScript.setAttribute(attr.name, attr.value);
                }
                script.replaceWith(newScript);
            })
        })
    </script>

    <script type="module">
        const {state,render} = lvDOM;
        async function Counter(state) {
            return render(
                {
                    tagName: "div",
                    attributes: {
                        style: {fontSize: "20px", color: "green"}
                    },
                    children: [
                        () => `Count: ${state.count}`,
                        {
                            tagName:"button",
                            attributes: {
                                style: {marginLeft: "10px"},
                                onclick: () => {state.count++;}
                            },
                            children: ["Increment"]
                        }
                    ]
                }
            )
        }
        document.getElementById("app").append(await Counter(state({count:0})));
    </script>

</body>
</html>