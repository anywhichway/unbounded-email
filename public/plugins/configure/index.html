<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Unbounded: Configure</title>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
        <link rel="stylesheet" href="../index.css">
        <link rel="stylesheet" href="./index.css">
        <script src="../../assets/js/lightview.js"></script>
        <script>
            const lightview = Lightview("browser");
            const {render, state, navigate} = lightview;
            // Make lightview available globally for component files
            window.lightview = lightview;
        </script>
        <script src="./index.js"></script>
        <script src="./configure.js"></script>
        <script src="./account-item.js"></script>
    </head>
    <body>
         <script type="module" id="init">
            const {user, ui} = await lightview.import("./");

            // Get user accounts from user structure
            const userAccounts = user.accounts || {};
            const accountEmails = Object.keys(userAccounts);
            const accounts =accountEmails.map(email => ({
                email: email,
                ...user.accounts[email]
            }));

            // Reactive state for configuration
            const appState = state({
                user: user,
                accountEmails: accountEmails,
                showAddAccountForm: false,
                newAccount: {
                    email: '',
                    type: 'Google',
                    name: '',
                    color: '#007bff'
                },
                accounts
            });
            document.getElementById("init").replaceWith(await Configure(appState))
        </script>
    </body>
</html>
